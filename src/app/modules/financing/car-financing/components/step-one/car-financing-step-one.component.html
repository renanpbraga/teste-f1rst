<section class="container">
  <h1 class="text-dark">Simulação de financiamento veicular</h1>
  <form
    class="gap-3 d-flex flex-column"
    [formGroup]="formData"
    (ngSubmit)="submit()"
  >
    <div class="row gy-3">
      <div class="col-12">
        <h4 class="heading">O que você deseja financiar?</h4>
      </div>
      <div class="col-xs-12">
        <h5 class="heading">Qual o tipo de veículo?</h5>
        <div class="form-check" *ngFor="let type of vehicleTypes">
          <input
            class="form-check-input"
            type="radio"
            name="vehicle-type"
            [id]="type.value"
            [value]="type.value"
            (change)="handleVehicleType($event)"
          />
          <label class="form-check-label" [for]="type.value">
            {{ type.title }}
          </label>
        </div>
      </div>
    </div>
    <div class="row gy-3">
      <div class="col-xs-12" *ngIf="f.vehicleType.value">
        <h5 class="heading">
          Onde deseja comprar
          {{ f.vehicleType.value === "CAR" ? "o carro" : "a moto" }}
        </h5>
        <div class="form-check" *ngFor="let type of vehicleSellerList">
          <input
            class="form-check-input"
            type="radio"
            name="vehicle-seller"
            [id]="type.value"
            [value]="type.value"
            (change)="handleVehicleSeller($event)"
          />
          <label class="form-check-label" [for]="type.value">
            {{ type.title }}
          </label>
        </div>
      </div>
    </div>
    <div class="row gy-3">
      <div class="col-xs-12" *ngIf="f.vehicleSeller.value">
        <h5 class="heading">Dados do vendedor</h5>
        <div class="row gy-3">
          <div class="col-6">
            <label class="form-label" for="vehicle-seller-name">
              Qual o nome da
              {{
                f.vehicleSeller.value === "DEALER"
                  ? "concessionária"
                  : "pessoa"
              }}?
            </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-name"
              formControlName="vehicleSellerName"
            />
          </div>
          <div class="col-6">
            <label class="form-label" for="vehicle-seller-name">
              Qual o
              {{ f.vehicleSeller.value === "DEALER" ? "CNPJ" : "CPF" }} do
              vendedor?
            </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-name"
              formControlName="vehicleSellerDocumentNumber"
              [mask]="
                f.vehicleSeller.value === 'DEALER'
                  ? '00.000.000/0000-00'
                  : '000.000.000-00'
              "
            />
          </div>
          <div class="col-2">
            <label class="form-label" for="vehicle-seller-zipcode">
              CEP do vendedor
            </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-zipcode"
              formControlName="vehicleSellerZipcode"
              (keyup)="autoCompleteAddress($event)"
            />
          </div>
          <div class="col-8">
            <label class="form-label" for="vehicle-seller-address">
              Endereço
            </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-address"
              formControlName="vehicleSellerAddress"
            />
          </div>
          <div class="col-2">
            <label class="form-label" for="vehicle-seller-address-number">
              Número
            </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-address-number"
              formControlName="vehicleSellerAddressNumber"
            />
          </div>
          <div class="col-5">
            <label class="form-label" for="vehicle-seller-district">
              Bairro
            </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-district"
              formControlName="vehicleSellerDistrict"
            />
          </div>
          <div class="col-5">
            <label class="form-label" for="vehicle-seller-city"> Cidade </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-city"
              formControlName="vehicleSellerCity"
            />
          </div>
          <div class="col-2">
            <label class="form-label" for="vehicle-seller-state">
              Estado
            </label>
            <input
              type="text"
              class="form-control"
              id="vehicle-seller-state"
              formControlName="vehicleSellerState"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="row gy-3" *ngIf="f.vehicleSellerZipcode.value">
      <div class="col-12">
        <h5 class="heading">Dados do veículo</h5>
      </div>
      <div class="col-3">
        <label for="vehicle-brand" class="form-label">Qual a marca?</label>
        <div
          *ngIf="isLoadingVehicleBrands"
          class="spinner-border spinner-border-sm"
          role="status"
        ></div>
        <select
          formControlName="vehicleBrand"
          id="vehicle-brand"
          class="form-select"
          (change)="getVehicleModels()"
        >
          <option value="" selected>Selecione...</option>
          <option
            *ngFor="let brand of vehicleBrandsList"
            [value]="brand.codigo"
          >
            {{ brand.nome }}
          </option>
        </select>
      </div>
      <div class="col-3">
        <label for="vehicle-model" class="form-label">Qual o modelo?</label>
        <div
          *ngIf="isLoadingVehicleModels"
          class="spinner-border spinner-border-sm"
          role="status"
        ></div>
        <select
          formControlName="vehicleModel"
          id="vehicle-model"
          class="form-select"
          (change)="getVehicleManufactureYears()"
        >
          <option value="" selected>Selecione...</option>
          <option
            *ngFor="let brand of vehicleModelsList"
            [value]="brand.codigo"
          >
            {{ brand.nome }}
          </option>
        </select>
      </div>
      <div class="col-3">
        <label for="vehicle-manufacture-year" class="form-label">
          Qual o ano?
        </label>
        <div
          *ngIf="isLoadingVehicleManufactureYears"
          class="spinner-border spinner-border-sm"
          role="status"
        ></div>
        <select
          formControlName="vehicleManufactureYear"
          id="vehicle-manufacture-year"
          class="form-select"
          (change)="getVehicleAveragePrice()"
        >
          <option value="" selected>Selecione...</option>
          <option
            *ngFor="let year of vehicleManufactureYearList"
            [value]="year.codigo"
          >
            {{ year.nome }}
          </option>
        </select>
      </div>
      <div class="col-3">
        <label for="vehicle-manufacture-year" class="form-label"
          >Valor médio</label
        >
        <div *ngIf="isLoadingVehicleAveragePrice" class="spinner-border spinner-border-sm" role="status"></div>
        <input
          type="text"
          class="form-control"
          id="vehicle-average-price"
          formControlName="vehicleAveragePrice"
        />
      </div>
    </div>
    <div class="row gy-3">
      <app-btn-loading>Enviar</app-btn-loading>
    </div>
  </form>
</section>
